{"ast":null,"code":"var _jsxFileName = \"/app/src/components/TicketOptionsMenu/index.js\";\nimport React, { useContext, useEffect, useRef, useState } from \"react\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport ConfirmationModal from \"../ConfirmationModal\";\nimport TransferTicketModalCustom from \"../TransferTicketModalCustom\";\nimport toastError from \"../../errors/toastError\";\nimport { Can } from \"../Can\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport ScheduleModal from \"../ScheduleModal\";\nconst TicketOptionsMenu = ({\n  ticket,\n  menuOpen,\n  handleClose,\n  anchorEl\n}) => {\n  const [confirmationOpen, setConfirmationOpen] = useState(false);\n  const [transferTicketModalOpen, setTransferTicketModalOpen] = useState(false);\n  const isMounted = useRef(true);\n  const {\n    user\n  } = useContext(AuthContext);\n  const [scheduleModalOpen, setScheduleModalOpen] = useState(false);\n  const [contactId, setContactId] = useState(null);\n  useEffect(() => {\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n  const handleDeleteTicket = async () => {\n    try {\n      await api.delete(`/tickets/${ticket.id}`);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n  const handleOpenConfirmationModal = e => {\n    setConfirmationOpen(true);\n    handleClose();\n  };\n  const handleOpenTransferModal = e => {\n    setTransferTicketModalOpen(true);\n    handleClose();\n  };\n  const handleCloseTransferTicketModal = () => {\n    if (isMounted.current) {\n      setTransferTicketModalOpen(false);\n    }\n  };\n  const handleOpenScheduleModal = () => {\n    handleClose();\n    setContactId(ticket.contact.id);\n    setScheduleModalOpen(true);\n  };\n  const handleCloseScheduleModal = () => {\n    setScheduleModalOpen(false);\n    setContactId(null);\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Menu, {\n    id: \"menu-appbar\",\n    anchorEl: anchorEl,\n    getContentAnchorEl: null,\n    anchorOrigin: {\n      vertical: \"bottom\",\n      horizontal: \"right\"\n    },\n    keepMounted: true,\n    transformOrigin: {\n      vertical: \"top\",\n      horizontal: \"right\"\n    },\n    open: menuOpen,\n    onClose: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    onClick: handleOpenScheduleModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }\n  }, i18n.t(\"ticketOptionsMenu.schedule\")), /*#__PURE__*/React.createElement(MenuItem, {\n    onClick: handleOpenTransferModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, i18n.t(\"ticketOptionsMenu.transfer\")), /*#__PURE__*/React.createElement(Can, {\n    role: user.profile,\n    perform: \"ticket-options:deleteTicket\",\n    yes: () => /*#__PURE__*/React.createElement(MenuItem, {\n      onClick: handleOpenConfirmationModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 7\n      }\n    }, i18n.t(\"ticketOptionsMenu.delete\")),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }\n  })), /*#__PURE__*/React.createElement(ConfirmationModal, {\n    title: `${i18n.t(\"ticketOptionsMenu.confirmationModal.title\")}${ticket.id} ${i18n.t(\"ticketOptionsMenu.confirmationModal.titleFrom\")} ${ticket.contact.name}?`,\n    open: confirmationOpen,\n    onClose: setConfirmationOpen,\n    onConfirm: handleDeleteTicket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 4\n    }\n  }, i18n.t(\"ticketOptionsMenu.confirmationModal.message\")), /*#__PURE__*/React.createElement(TransferTicketModalCustom, {\n    modalOpen: transferTicketModalOpen,\n    onClose: handleCloseTransferTicketModal,\n    ticketid: ticket.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(ScheduleModal, {\n    open: scheduleModalOpen,\n    onClose: handleCloseScheduleModal,\n    \"aria-labelledby\": \"form-dialog-title\",\n    contactId: contactId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 4\n    }\n  }));\n};\nexport default TicketOptionsMenu;","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","MenuItem","Menu","i18n","api","ConfirmationModal","TransferTicketModalCustom","toastError","Can","AuthContext","ScheduleModal","TicketOptionsMenu","ticket","menuOpen","handleClose","anchorEl","confirmationOpen","setConfirmationOpen","transferTicketModalOpen","setTransferTicketModalOpen","isMounted","user","scheduleModalOpen","setScheduleModalOpen","contactId","setContactId","current","handleDeleteTicket","delete","id","err","handleOpenConfirmationModal","e","handleOpenTransferModal","handleCloseTransferTicketModal","handleOpenScheduleModal","contact","handleCloseScheduleModal","createElement","Fragment","getContentAnchorEl","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","open","onClose","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","onClick","t","role","profile","perform","yes","title","name","onConfirm","modalOpen","ticketid"],"sources":["/app/src/components/TicketOptionsMenu/index.js"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\n\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport ConfirmationModal from \"../ConfirmationModal\";\nimport TransferTicketModalCustom from \"../TransferTicketModalCustom\";\nimport toastError from \"../../errors/toastError\";\nimport { Can } from \"../Can\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nimport ScheduleModal from \"../ScheduleModal\";\n\nconst TicketOptionsMenu = ({ ticket, menuOpen, handleClose, anchorEl }) => {\n\tconst [confirmationOpen, setConfirmationOpen] = useState(false);\n\tconst [transferTicketModalOpen, setTransferTicketModalOpen] = useState(false);\n\tconst isMounted = useRef(true);\n\tconst { user } = useContext(AuthContext);\n\n\tconst [scheduleModalOpen, setScheduleModalOpen] = useState(false);\n\tconst [contactId, setContactId] = useState(null);\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tisMounted.current = false;\n\t\t};\n\t}, []);\n\n\tconst handleDeleteTicket = async () => {\n\t\ttry {\n\t\t\tawait api.delete(`/tickets/${ticket.id}`);\n\t\t} catch (err) {\n\t\t\ttoastError(err);\n\t\t}\n\t};\n\n\tconst handleOpenConfirmationModal = e => {\n\t\tsetConfirmationOpen(true);\n\t\thandleClose();\n\t};\n\n\tconst handleOpenTransferModal = e => {\n\t\tsetTransferTicketModalOpen(true);\n\t\thandleClose();\n\t};\n\n\tconst handleCloseTransferTicketModal = () => {\n\t\tif (isMounted.current) {\n\t\t\tsetTransferTicketModalOpen(false);\n\t\t}\n\t};\n\n\tconst handleOpenScheduleModal = () => {\n\t\thandleClose();\n\t\tsetContactId(ticket.contact.id);\n\t\tsetScheduleModalOpen(true);\n\t}\n\n\tconst handleCloseScheduleModal = () => {\n\t\tsetScheduleModalOpen(false);\n\t\tsetContactId(null);\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Menu\n\t\t\t\tid=\"menu-appbar\"\n\t\t\t\tanchorEl={anchorEl}\n\t\t\t\tgetContentAnchorEl={null}\n\t\t\t\tanchorOrigin={{\n\t\t\t\t\tvertical: \"bottom\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\tkeepMounted\n\t\t\t\ttransformOrigin={{\n\t\t\t\t\tvertical: \"top\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\topen={menuOpen}\n\t\t\t\tonClose={handleClose}\n\t\t\t>\n\t\t\t\t<MenuItem onClick={handleOpenScheduleModal}>\n\t\t\t\t\t{i18n.t(\"ticketOptionsMenu.schedule\")}\n\t\t\t\t</MenuItem>\n\t\t\t\t<MenuItem onClick={handleOpenTransferModal}>\n\t\t\t\t\t{i18n.t(\"ticketOptionsMenu.transfer\")}\n\t\t\t\t</MenuItem>\n\t\t\t\t<Can\n\t\t\t\t\trole={user.profile}\n\t\t\t\t\tperform=\"ticket-options:deleteTicket\"\n\t\t\t\t\tyes={() => (\n\t\t\t\t\t\t<MenuItem onClick={handleOpenConfirmationModal}>\n\t\t\t\t\t\t\t{i18n.t(\"ticketOptionsMenu.delete\")}\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Menu>\n\t\t\t<ConfirmationModal\n\t\t\t\ttitle={`${i18n.t(\"ticketOptionsMenu.confirmationModal.title\")}${\n\t\t\t\t\tticket.id\n\t\t\t\t} ${i18n.t(\"ticketOptionsMenu.confirmationModal.titleFrom\")} ${\n\t\t\t\t\tticket.contact.name\n\t\t\t\t}?`}\n\t\t\t\topen={confirmationOpen}\n\t\t\t\tonClose={setConfirmationOpen}\n\t\t\t\tonConfirm={handleDeleteTicket}\n\t\t\t>\n\t\t\t\t{i18n.t(\"ticketOptionsMenu.confirmationModal.message\")}\n\t\t\t</ConfirmationModal>\n\t\t\t<TransferTicketModalCustom\n\t\t\t\tmodalOpen={transferTicketModalOpen}\n\t\t\t\tonClose={handleCloseTransferTicketModal}\n\t\t\t\tticketid={ticket.id}\n\t\t\t/>\n\t\t\t<ScheduleModal\n\t\t\t\topen={scheduleModalOpen}\n\t\t\t\tonClose={handleCloseScheduleModal}\n\t\t\t\taria-labelledby=\"form-dialog-title\"\n\t\t\t\tcontactId={contactId}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default TicketOptionsMenu;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}