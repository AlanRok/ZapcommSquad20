{"ast":null,"code":"'use strict';\n\n// adapted from https://github.com/apatil/pemstrip\nvar findProc = /Proc-Type: 4,ENCRYPTED[\\n\\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\\n\\r]+([0-9A-z\\n\\r+/=]+)[\\n\\r]+/m;\nvar startRegex = /^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m;\nvar fullRegex = /^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\\n\\r+/=]+)-----END \\1-----$/m;\nvar evp = require('evp_bytestokey');\nvar ciphers = require('browserify-aes');\nvar Buffer = require('safe-buffer').Buffer;\nmodule.exports = function (okey, password) {\n  var key = okey.toString();\n  var match = key.match(findProc);\n  var decrypted;\n  if (!match) {\n    var match2 = key.match(fullRegex);\n    decrypted = Buffer.from(match2[2].replace(/[\\r\\n]/g, ''), 'base64');\n  } else {\n    var suite = 'aes' + match[1];\n    var iv = Buffer.from(match[2], 'hex');\n    var cipherText = Buffer.from(match[3].replace(/[\\r\\n]/g, ''), 'base64');\n    var cipherKey = evp(password, iv.slice(0, 8), parseInt(match[1], 10)).key;\n    var out = [];\n    var cipher = ciphers.createDecipheriv(suite, cipherKey, iv);\n    out.push(cipher.update(cipherText));\n    out.push(cipher['final']());\n    decrypted = Buffer.concat(out);\n  }\n  var tag = key.match(startRegex)[1];\n  return {\n    tag: tag,\n    data: decrypted\n  };\n};","map":{"version":3,"names":["findProc","startRegex","fullRegex","evp","require","ciphers","Buffer","module","exports","okey","password","key","toString","match","decrypted","match2","from","replace","suite","iv","cipherText","cipherKey","slice","parseInt","out","cipher","createDecipheriv","push","update","concat","tag","data"],"sources":["/app/node_modules/parse-asn1/fixProc.js"],"sourcesContent":["'use strict';\n\n// adapted from https://github.com/apatil/pemstrip\nvar findProc = /Proc-Type: 4,ENCRYPTED[\\n\\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\\n\\r]+([0-9A-z\\n\\r+/=]+)[\\n\\r]+/m;\nvar startRegex = /^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m;\nvar fullRegex = /^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\\n\\r+/=]+)-----END \\1-----$/m;\nvar evp = require('evp_bytestokey');\nvar ciphers = require('browserify-aes');\nvar Buffer = require('safe-buffer').Buffer;\nmodule.exports = function (okey, password) {\n\tvar key = okey.toString();\n\tvar match = key.match(findProc);\n\tvar decrypted;\n\tif (!match) {\n\t\tvar match2 = key.match(fullRegex);\n\t\tdecrypted = Buffer.from(match2[2].replace(/[\\r\\n]/g, ''), 'base64');\n\t} else {\n\t\tvar suite = 'aes' + match[1];\n\t\tvar iv = Buffer.from(match[2], 'hex');\n\t\tvar cipherText = Buffer.from(match[3].replace(/[\\r\\n]/g, ''), 'base64');\n\t\tvar cipherKey = evp(password, iv.slice(0, 8), parseInt(match[1], 10)).key;\n\t\tvar out = [];\n\t\tvar cipher = ciphers.createDecipheriv(suite, cipherKey, iv);\n\t\tout.push(cipher.update(cipherText));\n\t\tout.push(cipher['final']());\n\t\tdecrypted = Buffer.concat(out);\n\t}\n\tvar tag = key.match(startRegex)[1];\n\treturn {\n\t\ttag: tag,\n\t\tdata: decrypted\n\t};\n};\n"],"mappings":"AAAA,YAAY;;AAEZ;AACA,IAAIA,QAAQ,GAAG,uHAAuH;AACtI,IAAIC,UAAU,GAAG,6CAA6C;AAC9D,IAAIC,SAAS,GAAG,gFAAgF;AAChG,IAAIC,GAAG,GAAGC,OAAO,CAAC,gBAAgB,CAAC;AACnC,IAAIC,OAAO,GAAGD,OAAO,CAAC,gBAAgB,CAAC;AACvC,IAAIE,MAAM,GAAGF,OAAO,CAAC,aAAa,CAAC,CAACE,MAAM;AAC1CC,MAAM,CAACC,OAAO,GAAG,UAAUC,IAAI,EAAEC,QAAQ,EAAE;EAC1C,IAAIC,GAAG,GAAGF,IAAI,CAACG,QAAQ,CAAC,CAAC;EACzB,IAAIC,KAAK,GAAGF,GAAG,CAACE,KAAK,CAACb,QAAQ,CAAC;EAC/B,IAAIc,SAAS;EACb,IAAI,CAACD,KAAK,EAAE;IACX,IAAIE,MAAM,GAAGJ,GAAG,CAACE,KAAK,CAACX,SAAS,CAAC;IACjCY,SAAS,GAAGR,MAAM,CAACU,IAAI,CAACD,MAAM,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,EAAE,QAAQ,CAAC;EACpE,CAAC,MAAM;IACN,IAAIC,KAAK,GAAG,KAAK,GAAGL,KAAK,CAAC,CAAC,CAAC;IAC5B,IAAIM,EAAE,GAAGb,MAAM,CAACU,IAAI,CAACH,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC;IACrC,IAAIO,UAAU,GAAGd,MAAM,CAACU,IAAI,CAACH,KAAK,CAAC,CAAC,CAAC,CAACI,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,EAAE,QAAQ,CAAC;IACvE,IAAII,SAAS,GAAGlB,GAAG,CAACO,QAAQ,EAAES,EAAE,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAEC,QAAQ,CAACV,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAACF,GAAG;IACzE,IAAIa,GAAG,GAAG,EAAE;IACZ,IAAIC,MAAM,GAAGpB,OAAO,CAACqB,gBAAgB,CAACR,KAAK,EAAEG,SAAS,EAAEF,EAAE,CAAC;IAC3DK,GAAG,CAACG,IAAI,CAACF,MAAM,CAACG,MAAM,CAACR,UAAU,CAAC,CAAC;IACnCI,GAAG,CAACG,IAAI,CAACF,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC3BX,SAAS,GAAGR,MAAM,CAACuB,MAAM,CAACL,GAAG,CAAC;EAC/B;EACA,IAAIM,GAAG,GAAGnB,GAAG,CAACE,KAAK,CAACZ,UAAU,CAAC,CAAC,CAAC,CAAC;EAClC,OAAO;IACN6B,GAAG,EAAEA,GAAG;IACRC,IAAI,EAAEjB;EACP,CAAC;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script"}